{"version":3,"sources":["webpack:///src/Pages/Contract/index.vue","webpack:///./src/Pages/Contract/index.vue?51da","webpack:///./src/Pages/Contract/index.vue"],"names":["Contract","breadcrumbBar","Breadcrumb","optionDetailTemplate","option_detail","dataTable","DataTable","myAction","my_action","myInput","my_input","myAutoComplete","my_autocomp","name","route","key","active","icon","title","index","getTechnicianData","_this","this","queryString","data","_this2","code","project","contract","contractTime","progress","assign","_this3","time","checked","id","resourceName","_this4","validateAll","type","_context4","t0","isValid","value","selected","house_id","idSelected","orderingData","obj","date_start","newFormat","dateDiff","is-white","status","is-warning","is-success","delay","is-danger","_this5","_this6","Pages_Contract","render","_vm","_h","$createElement","_c","_self","attrs","templateObj","local","pageObj","template","isSelected","on","cancleForm","$event","submitForm","slot","dataObj","_v","ref","statusSearch","selectedData","selectedDataHandle","staticClass","_s","GET_WORKSTATUS","inputs","click","GOTOPAGE","contractPlan","getDateFromContract","SET_DATEFORMAT","technician","inputObj","inputValue","placeholder","validate","validator","$validator","input","getTechnicianName","width","_l","item","order","start_date","end_date","condition","real_date","isBlur","onBlur","setRealDate","class","getDelayClass","_e","getStatusClass","getWorkingStatus","refInFor","domProps","is_success","change","updateContractTime","color","isConfirm","clickEvent","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/15.b6d75904796c6d2eba3b.js","sourcesContent":["<template>\n  <option-detail-template :templateObj=\"local.pageObj.template\" :isSelected=\"local.idSelected\"  @cancleForm=\"submitForm('cancel')\">\n    <template slot=\"title\"><breadcrumb-bar :dataObj=\"local.pageObj\"></breadcrumb-bar></template>\n    <template slot=\"data-table\">\n      <data-table ref=\"dataTable\"\n      :resourceName=\"resourceName\"\n      :statusSearch=\"local.statusSearch\"\n      @selectedData=\"selectedDataHandle\"\n      ></data-table>\n    </template>\n    <template v-if=\"local.idSelected\">\n      <template slot=\"detail\">\n        <div class=\"container-block  detail-block\">\n          <span class=\"type tag\">{{GET_WORKSTATUS(local.inputs.contract.status)}}</span>\n          <div class=\"block c-header\">\n            <table class=\"transparent-table\">\n              <tr>\n              <td>\n                โครงการ:<span class=\"value is-linkpage\" @click=\"GOTOPAGE('Project', local.inputs.project.name)\">{{local.inputs.project.name}}</span>\n                <!-- <button @click=\"resetContract()\">reset</button> -->\n              </td>\n              </tr>\n              <tr>\n                <td>เลขที่สัญญา:<span class=\"value\">{{local.inputs.contract.code}}</span></td>\n                <td>แบบบ้าน:<span class=\"value\">{{local.inputs.contract.house_id}}</span></td>\n              </tr>\n              <tr>\n                <td>แปลง: <span class=\"value\">{{local.inputs.contract.contractPlan}}</span></td>\n                <td></td>\n              </tr>\n              <tr>\n                <td>วันที่งวด 9 ตามส/ญ:<span class=\"value\">{{getDateFromContract(9)}}</span></td>\n                <td>วันที่งวด 9 ตามปมก.:<span class=\"value\">{{getDateFromContract(9)}}</span></td>\n              </tr>\n              <tr>\n                <td>วันที่ End Prod.ตามส/ญ:<span class=\"value\">{{getDateFromContract(10)}}</span></td>\n                <td>วันที่ทำสัญญา:<span class=\"value\">{{SET_DATEFORMAT(local.inputs.contract.date_start)}}</span></td>\n              </tr>\n              <tr>\n                <td>\n                  <div class=\"container-block technician\">\n                    <div class=\"block title-name\">ผู้รับมอบหมาย:</div>\n                    <div class=\"block\">\n                      <my-input\n                      v-if=\"local.inputs.contract.status !== 'done'\"\n                      :value=\"local.technician.selected\"\n                      :inputObj=\"{type: 'select', icon: 'user', inputValue: local.technician.inputs, name: 'technician', placeholder: 'ผู้รับมอบหมาย', validate: 'required'}\"\n                      :validator=\"$validator\"\n                      @input=\"value => { local.technician.selected = value }\"\n                      ></my-input>\n                      <p v-else>{{getTechnicianName()}}</p>\n                    </div>\n                  </div>\n                </td>\n                <td></td>\n              </tr>\n            </table>\n          </div>\n          <div class=\"block c-body\">\n            <table class=\"table rows-table is-hoverable\">\n              <thead>\n                <tr>\n                  <th>งวด/ลำดับงาน</th>\n                  <th>รายละเอียดงาน</th>\n                  <th width=\"120\">กำหนดเริ่มงาน</th>\n                  <th width=\"120\">กำหนดเสร็จงาน</th>\n                  <th width=\"120\">วันที่เสร็จจริง</th>\n                  <th width=\"50\">delay</th>\n                  <th>สถานะ</th>\n                  <!-- <th>งวด</th> -->\n                </tr>\n              </thead>\n              <tbody>\n                <tr :key=\"index\" v-for=\"(item, index) in local.inputs.progress\">\n                  <td>{{item.time}}/{{item.order}}</td>\n                  <td>{{item.name}}</td>\n                  <td>\n                    {{SET_DATEFORMAT(item.start_date)}}\n                  </td>\n                  <td>{{SET_DATEFORMAT(item.end_date)}}</td>\n                  <td>\n                    <!-- {{SET_DATEFORMAT(item.real_date)}} -->\n                    <my-input\n                    v-if=\"local.inputs.contract.status == 'ip' && item.condition !== null\"\n                    :value=\"SET_DATEFORMAT(item.real_date)\"\n                    :inputObj=\"{type: 'text', isBlur: true, name: 'contract_datestart', placeholder: 'YYYY/MM/DD', validate: ''}\"\n                    :validator=\"$validator\"\n                    @onBlur=\"value => setRealDate(value, index)\"\n                    ></my-input>\n                    <p v-else>{{SET_DATEFORMAT(item.real_date)}}</p>\n                  </td>\n                  <td>\n                    <span v-if=\"item.condition !== null\" :class=\"getDelayClass(item.delay, item.status)\">{{item.delay}}</span>\n                  </td>\n                  <td>\n                    <span :class=\"getStatusClass(item.status)\">{{getWorkingStatus(item.status)}}</span>\n                  </td>\n                </tr>\n              </tbody>\n            </table>\n          </div>\n          <div class=\"block c-extend\" v-if=\"local.inputs.contract.status == 'ip'\">\n            <div class=\"container-block period\">\n              <div class=\"block container-block\" :key=\"index\" v-for=\"(item, index) in local.inputs.contractTime\">\n                <label class=\"checkbox\" >\n                  <input type=\"checkbox\" @change=\"updateContractTime(item.id, item.time)\" :ref=\"`time_${item.time}`\" :checked=\"item.is_success\">\n                  งวดที่ {{item.time}}\n                </label>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div class=\"container-block footer-panel\" v-if=\"local.inputs.contract.status !== 'done'\">\n          <my-action\n            type=\"updateStatus\"\n            :obj=\"{title: 'เริ่มดำเนินงาน (ทำสัญญาเสร็จสิ้น)', color: 'is-warning', isConfirm: true}\"\n            @clickEvent=\"submitForm('updateStatus', 'ip')\"\n            v-if=\"local.inputs.contract.status == 'wait'\"\n          >\n          </my-action>\n          <my-action\n            type=\"update\"\n            :obj=\"{title: 'ปิดงาน (เสร็จสิ้น)', color: 'is-success', isConfirm: true}\"\n            @clickEvent=\"submitForm('updateStatus', 'done')\"\n            v-if=\"local.inputs.contract.status == 'ip'\"\n          >\n          </my-action>\n          <my-action\n            type=\"update\"\n            :obj=\"{title: 'บันทึกข้อมูล', color: 'is-info', isConfirm: true}\"\n            @clickEvent=\"submitForm('updateProgress')\"\n            v-if=\"local.inputs.contract.status == 'ip'\"\n          >\n          </my-action>\n        </div>\n      </template>\n    </template>\n  </option-detail-template>\n</template>\n\n<script>\nimport {bus} from '@/main'\nimport breadcrumbBar from '@Components/Breadcrumb'\nimport optionDetailTemplate from '@Components/Template/option-detail'\nimport config from '@Config/app.config'\nimport service from '@Services/app-service'\nimport dataTable from '@Components/DataTable'\nimport myAction from '@Components/Form/my-action'\nimport myInput from '@Components/Form/my-input'\nimport myAutoComplete from '@Components/Form/my-autocomp'\nexport default {\n  props: {\n  },\n  components: {\n    breadcrumbBar,\n    optionDetailTemplate,\n    dataTable,\n    myAction,\n    myInput,\n    myAutoComplete\n  },\n  name: 'ContractPage',\n  data () {\n    return {\n      local: {\n        pageObj: {\n          items: [\n            {name: 'ข้อมูลสัญญา', route: 'Contract', key: 'test', active: true, icon: 'fa fa-file-text'}\n          ],\n          template: {\n            class: 'contract-page'\n          }\n        },\n        statusSearch: [\n          {title: 'ทั้งหมด', key: ''},\n          {title: 'เสร็จสิ้น', key: 'done'},\n          {title: 'รออนุมัติ', key: 'wait'},\n          {title: 'ดำเนินการ', key: 'ip'}\n        ],\n        idSelected: null,\n        inputs: {\n          project: {},\n          contractTime: {},\n          contract: {},\n          progress: null\n        },\n        technician: {\n          inputs: [],\n          selected: null\n        }\n      }\n    }\n  },\n  computed: {\n    resourceName () {\n      return config.api.contract.index\n    }\n  },\n  created () {\n    this.getTechnicianData()\n  },\n  mounted () {\n    if (this.$route.params.key !== undefined && this.$route.params.key !== 'all') {\n      this.$refs.dataTable.searchByText({value: this.$route.params.key})\n    }\n    // this.$refs.dataTable[0].searchByText({value: this.$route.params.key})\n  },\n  methods: {\n    async getTechnicianData () {\n      let queryString = this.BUILDPARAM({type: 'technician'})\n      let obj = await service.getResource({resourceName: config.api.users.dropdown, queryString})\n      this.local.technician.inputs = obj.data\n    },\n    // technicianSelectedHandle (objVal) {\n    //   this.local.technician.selected = objVal.key\n    // },\n    async selectedDataHandle (item) {\n      this.local.idSelected = item.code\n      let queryString = this.BUILDPARAM({type: 'full'})\n      let contractItem = await service.getResource({\n        resourceName: `${config.api.contract.index}/${item.code}`,\n        queryString\n      })\n      this.local.inputs.project = contractItem.data.project\n      this.local.inputs.contract = contractItem.data.contract\n      this.local.inputs.contractTime = contractItem.data.contractTime\n      this.local.inputs.progress = contractItem.data.progress\n      if (this.local.inputs.contract.assign) {\n        this.local.technician.selected = this.local.inputs.contract.assign\n      } else {\n        this.local.technician.selected = ''\n      }\n    },\n    async updateContractTime (id, time) {\n      let ele = `time_${time}`\n      let data = {\n        isSuccess: this.$refs[ele][0].checked\n      }\n      let resourceName = `${config.api.contract.time}/${id}`\n      let res = await service.putResource({data, resourceName})\n      if (res.status === 200) {\n        this.NOTIFY('success')\n      } else {\n        this.NOTIFY('error')\n      }\n    },\n    async submitForm (type, value = '') {\n      let isValid = await this.$validator.validateAll()\n      let resourceName = this.resourceName\n      // if (type === 'update' && this.local.idSelected === 'new') type = 'save'\n      let data = {}\n      let res = null\n      switch (type) {\n        case 'add':\n          // this.local.idSelected = 'new'\n          // this.cleanInput()\n          return\n        case 'cancel':\n          this.local.idSelected = null\n          return\n        case 'updateStatus':\n          if (!isValid) return\n          data.status = value\n          data.assign = this.local.technician.selected\n          data.houseId = this.local.inputs.contract.house_id\n          resourceName = `${config.api.contract.status}/${this.local.idSelected}`\n          res = await service.putResource({data, resourceName})\n          let obj = res.data.orderingData\n          bus.$emit('setNotification', {type: 'ordering', value: obj})\n          break\n        // case 'update':\n        //   if (!isValid) return\n        //   resourceName = `${config.api.contract.index}/${this.local.idSelected}`\n        //   data = this.local.inputs.progress\n        //   res = await service.putResource({data, resourceName})\n        //   break\n        case 'updateProgress':\n          resourceName = `${config.api.contract.progress}/${this.local.idSelected}`\n          data.progress = this.local.inputs.progress\n          data.assign = this.local.technician.selected\n          res = await service.putResource({data, resourceName})\n          break\n        case 'save':\n          // if (!isValid) return\n          // data = this.local.inputs\n          // res = await service.postResource({data, resourceName})\n          break\n      }\n      if (res.status === 200) {\n        this.local.idSelected = null\n        this.NOTIFY('success')\n        return\n      }\n      this.NOTIFY('error')\n    },\n    getWorkingStatus (code) {\n      return config.variable.workingStatus[code]\n    },\n    getDateFromContract (time) {\n      // console.log(this.local.inputs.contractTime)\n      if (this.local.inputs.contractTime[0] !== undefined) {\n        return this.SET_DATEFORMAT(this.local.inputs.contractTime[time - 1].date_start)\n      }\n      return null\n    },\n    setRealDate (value, index) {\n      let newFormat = this.SET_DATEFORMAT(value)\n      let dateDiff = this.GET_DATEDIFF(this.local.inputs.progress[index].end_date, newFormat)\n      if (isNaN(dateDiff)) {\n        dateDiff = 0\n      }\n      this.local.inputs.progress[index].delay = Math.ceil(dateDiff)\n      this.local.inputs.progress[index].real_date = value\n    },\n    getStatusClass (status) {\n      return [\n        'tag',\n        {'is-white': status === 'wait'},\n        {'is-warning': status === 'ip'},\n        {'is-success': status === 'done'}\n      ]\n    },\n    getDelayClass (delay, status) {\n      return [\n        'tag',\n        {'is-success': delay <= 0 && status === 'done'},\n        {'is-danger': delay > 0 && status === 'done'}\n      ]\n    },\n    async resetContract () {\n      let res = await service.getResource({\n        resourceName: `${config.api.contract.reset}/${this.local.idSelected}`,\n        queryString: []\n      })\n      if (res.status === 200) {\n        this.NOTIFY('success')\n      }\n    },\n    getTechnicianName () {\n      let obj = this.local.technician.inputs.filter((item) => {\n        return item.key === this.local.technician.selected\n      })[0]\n      return obj.name\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.technician {\n  .title-name{\n    flex: 0;\n    min-width: 100px;\n    margin-right: 5px;\n  }\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/Pages/Contract/index.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('option-detail-template',{attrs:{\"templateObj\":_vm.local.pageObj.template,\"isSelected\":_vm.local.idSelected},on:{\"cancleForm\":function($event){_vm.submitForm('cancel')}}},[_c('template',{slot:\"title\"},[_c('breadcrumb-bar',{attrs:{\"dataObj\":_vm.local.pageObj}})],1),_vm._v(\" \"),_c('template',{slot:\"data-table\"},[_c('data-table',{ref:\"dataTable\",attrs:{\"resourceName\":_vm.resourceName,\"statusSearch\":_vm.local.statusSearch},on:{\"selectedData\":_vm.selectedDataHandle}})],1),_vm._v(\" \"),(_vm.local.idSelected)?[_c('template',{slot:\"detail\"},[_c('div',{staticClass:\"container-block  detail-block\"},[_c('span',{staticClass:\"type tag\"},[_vm._v(_vm._s(_vm.GET_WORKSTATUS(_vm.local.inputs.contract.status)))]),_vm._v(\" \"),_c('div',{staticClass:\"block c-header\"},[_c('table',{staticClass:\"transparent-table\"},[_c('tr',[_c('td',[_vm._v(\"\\n              โครงการ:\"),_c('span',{staticClass:\"value is-linkpage\",on:{\"click\":function($event){_vm.GOTOPAGE('Project', _vm.local.inputs.project.name)}}},[_vm._v(_vm._s(_vm.local.inputs.project.name))])])]),_vm._v(\" \"),_c('tr',[_c('td',[_vm._v(\"เลขที่สัญญา:\"),_c('span',{staticClass:\"value\"},[_vm._v(_vm._s(_vm.local.inputs.contract.code))])]),_vm._v(\" \"),_c('td',[_vm._v(\"แบบบ้าน:\"),_c('span',{staticClass:\"value\"},[_vm._v(_vm._s(_vm.local.inputs.contract.house_id))])])]),_vm._v(\" \"),_c('tr',[_c('td',[_vm._v(\"แปลง: \"),_c('span',{staticClass:\"value\"},[_vm._v(_vm._s(_vm.local.inputs.contract.contractPlan))])]),_vm._v(\" \"),_c('td')]),_vm._v(\" \"),_c('tr',[_c('td',[_vm._v(\"วันที่งวด 9 ตามส/ญ:\"),_c('span',{staticClass:\"value\"},[_vm._v(_vm._s(_vm.getDateFromContract(9)))])]),_vm._v(\" \"),_c('td',[_vm._v(\"วันที่งวด 9 ตามปมก.:\"),_c('span',{staticClass:\"value\"},[_vm._v(_vm._s(_vm.getDateFromContract(9)))])])]),_vm._v(\" \"),_c('tr',[_c('td',[_vm._v(\"วันที่ End Prod.ตามส/ญ:\"),_c('span',{staticClass:\"value\"},[_vm._v(_vm._s(_vm.getDateFromContract(10)))])]),_vm._v(\" \"),_c('td',[_vm._v(\"วันที่ทำสัญญา:\"),_c('span',{staticClass:\"value\"},[_vm._v(_vm._s(_vm.SET_DATEFORMAT(_vm.local.inputs.contract.date_start)))])])]),_vm._v(\" \"),_c('tr',[_c('td',[_c('div',{staticClass:\"container-block technician\"},[_c('div',{staticClass:\"block title-name\"},[_vm._v(\"ผู้รับมอบหมาย:\")]),_vm._v(\" \"),_c('div',{staticClass:\"block\"},[(_vm.local.inputs.contract.status !== 'done')?_c('my-input',{attrs:{\"value\":_vm.local.technician.selected,\"inputObj\":{type: 'select', icon: 'user', inputValue: _vm.local.technician.inputs, name: 'technician', placeholder: 'ผู้รับมอบหมาย', validate: 'required'},\"validator\":_vm.$validator},on:{\"input\":function (value) { _vm.local.technician.selected = value }}}):_c('p',[_vm._v(_vm._s(_vm.getTechnicianName()))])],1)])]),_vm._v(\" \"),_c('td')])])]),_vm._v(\" \"),_c('div',{staticClass:\"block c-body\"},[_c('table',{staticClass:\"table rows-table is-hoverable\"},[_c('thead',[_c('tr',[_c('th',[_vm._v(\"งวด/ลำดับงาน\")]),_vm._v(\" \"),_c('th',[_vm._v(\"รายละเอียดงาน\")]),_vm._v(\" \"),_c('th',{attrs:{\"width\":\"120\"}},[_vm._v(\"กำหนดเริ่มงาน\")]),_vm._v(\" \"),_c('th',{attrs:{\"width\":\"120\"}},[_vm._v(\"กำหนดเสร็จงาน\")]),_vm._v(\" \"),_c('th',{attrs:{\"width\":\"120\"}},[_vm._v(\"วันที่เสร็จจริง\")]),_vm._v(\" \"),_c('th',{attrs:{\"width\":\"50\"}},[_vm._v(\"delay\")]),_vm._v(\" \"),_c('th',[_vm._v(\"สถานะ\")])])]),_vm._v(\" \"),_c('tbody',_vm._l((_vm.local.inputs.progress),function(item,index){return _c('tr',{key:index},[_c('td',[_vm._v(_vm._s(item.time)+\"/\"+_vm._s(item.order))]),_vm._v(\" \"),_c('td',[_vm._v(_vm._s(item.name))]),_vm._v(\" \"),_c('td',[_vm._v(\"\\n                  \"+_vm._s(_vm.SET_DATEFORMAT(item.start_date))+\"\\n                \")]),_vm._v(\" \"),_c('td',[_vm._v(_vm._s(_vm.SET_DATEFORMAT(item.end_date)))]),_vm._v(\" \"),_c('td',[(_vm.local.inputs.contract.status == 'ip' && item.condition !== null)?_c('my-input',{attrs:{\"value\":_vm.SET_DATEFORMAT(item.real_date),\"inputObj\":{type: 'text', isBlur: true, name: 'contract_datestart', placeholder: 'YYYY/MM/DD', validate: ''},\"validator\":_vm.$validator},on:{\"onBlur\":function (value) { return _vm.setRealDate(value, index); }}}):_c('p',[_vm._v(_vm._s(_vm.SET_DATEFORMAT(item.real_date)))])],1),_vm._v(\" \"),_c('td',[(item.condition !== null)?_c('span',{class:_vm.getDelayClass(item.delay, item.status)},[_vm._v(_vm._s(item.delay))]):_vm._e()]),_vm._v(\" \"),_c('td',[_c('span',{class:_vm.getStatusClass(item.status)},[_vm._v(_vm._s(_vm.getWorkingStatus(item.status)))])])])}))])]),_vm._v(\" \"),(_vm.local.inputs.contract.status == 'ip')?_c('div',{staticClass:\"block c-extend\"},[_c('div',{staticClass:\"container-block period\"},_vm._l((_vm.local.inputs.contractTime),function(item,index){return _c('div',{key:index,staticClass:\"block container-block\"},[_c('label',{staticClass:\"checkbox\"},[_c('input',{ref:(\"time_\" + (item.time)),refInFor:true,attrs:{\"type\":\"checkbox\"},domProps:{\"checked\":item.is_success},on:{\"change\":function($event){_vm.updateContractTime(item.id, item.time)}}}),_vm._v(\"\\n                งวดที่ \"+_vm._s(item.time)+\"\\n              \")])])}))]):_vm._e()]),_vm._v(\" \"),(_vm.local.inputs.contract.status !== 'done')?_c('div',{staticClass:\"container-block footer-panel\"},[(_vm.local.inputs.contract.status == 'wait')?_c('my-action',{attrs:{\"type\":\"updateStatus\",\"obj\":{title: 'เริ่มดำเนินงาน (ทำสัญญาเสร็จสิ้น)', color: 'is-warning', isConfirm: true}},on:{\"clickEvent\":function($event){_vm.submitForm('updateStatus', 'ip')}}}):_vm._e(),_vm._v(\" \"),(_vm.local.inputs.contract.status == 'ip')?_c('my-action',{attrs:{\"type\":\"update\",\"obj\":{title: 'ปิดงาน (เสร็จสิ้น)', color: 'is-success', isConfirm: true}},on:{\"clickEvent\":function($event){_vm.submitForm('updateStatus', 'done')}}}):_vm._e(),_vm._v(\" \"),(_vm.local.inputs.contract.status == 'ip')?_c('my-action',{attrs:{\"type\":\"update\",\"obj\":{title: 'บันทึกข้อมูล', color: 'is-info', isConfirm: true}},on:{\"clickEvent\":function($event){_vm.submitForm('updateProgress')}}}):_vm._e()],1):_vm._e()])]:_vm._e()],2)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-5d3473ac\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/Pages/Contract/index.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-5d3473ac\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./index.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./index.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./index.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-5d3473ac\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./index.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-5d3473ac\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/Pages/Contract/index.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}