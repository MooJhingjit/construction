webpackJsonp([15],{HWSm:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("Xxa5"),n=a.n(i),s=a("exGp"),r=a.n(s),o=a("ujS/"),l=a("ikD4"),c=a("kVPM"),u=a("Tdo9"),d=a("7x59"),p=a("7Dwl"),m={props:{},components:{breadcrumbBar:o.a,myAutoComplete:u.a,myAction:d.a,myInput:p.a},name:"WorkSheetPage",data:function(){return{local:{pageObj:{items:[{name:"หมวดงาน",route:"WorkGroup",key:"",active:!0,icon:"fa fa-th"}],template:{class:"workgroup-details-page"}},houseTemplate:{inputs:[],selected:null},itemName:"",itemLists:[],inputTemplate:{time:1,name:"",unit:"",price:0,note:""}}}},computed:{},created:function(){var t=this;return r()(n.a.mark(function e(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getHouseTemplate();case 2:case"end":return e.stop()}},e,t)}))()},methods:{getHouseTemplate:function(){var t=this;return r()(n.a.mark(function e(){var a,i;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={},e.next=3,l.a.getResource({resourceName:c.a.api.house.dropdown,queryString:a});case 3:i=e.sent,t.local.houseTemplate.inputs=i.data;case 5:case"end":return e.stop()}},e,t)}))()},fetchData:function(){var t=this;return r()(n.a.mark(function e(){var a,i,s,r;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.clearInputs(),a=t.local.houseTemplate.selected,i=t.BUILDPARAM({houseId:a,type:"with-detail"}),e.next=5,l.a.getResource({resourceName:c.a.api.workGroup.index+"/"+t.$route.params.key,queryString:i});case 5:s=e.sent,r=s.data[0],t.local.itemName=r.name,void 0!==r.details&&r.details.length?r.details.map(function(e){t.local.itemLists.push({time:e.time,name:e.name,unit:e.unit,price:e.price,note:e.note})}):t.local.itemLists.push(t.local.inputTemplate);case 9:case"end":return e.stop()}},e,t)}))()},houseSelectedHandle:function(t){null!==t&&(this.local.houseTemplate.selected=t.key,this.fetchData())},editRow:function(t){"add"===t?this.local.itemLists.push({}):this.local.itemLists.pop()},submitForm:function(t){var e=this;return r()(n.a.mark(function a(){var i,s,r,o;return n.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.$validator.validateAll();case 2:i=a.sent,s="",r={},o=null,a.t0=t,a.next="update"===a.t0?9:"delete"===a.t0?17:18;break;case 9:if(i){a.next=11;break}return a.abrupt("return");case 11:return r={houseId:e.local.houseTemplate.selected,itemLists:e.local.itemLists},s=c.a.api.workGroup.detail+"/"+e.$route.params.key,a.next=15,l.a.putResource({data:r,resourceName:s});case 15:return o=a.sent,a.abrupt("break",18);case 17:return a.abrupt("break",18);case 18:if(200!==o.status){a.next=21;break}return e.NOTIFY("success"),a.abrupt("return");case 21:e.NOTIFY("error");case 22:case"end":return a.stop()}},a,e)}))()},deleteTime:function(t){this.local.itemLists.splice(t,1)},clearInputs:function(){this.local.itemLists=[]}}},v={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{class:["section",t.local.pageObj.template.class]},[a("breadcrumb-bar",{attrs:{dataObj:t.local.pageObj}}),t._v(" "),a("div",{staticClass:"container-block"},[a("div",{staticClass:"detail-panel"},[[a("div",{staticClass:"container-block detail-block"},[a("div",{staticClass:"c-body"},[a("div",{staticClass:"items"},[a("div",{staticClass:"item"},[a("div",{staticClass:"item-header container-block"},[a("div",{staticClass:"time block"},[t._v(t._s(this.local.itemName)+" "+t._s(this.local.houseTemplate.selected))]),t._v(" "),a("div",{staticClass:"order-name container-block block"},[a("span",{staticClass:"name"},[t._v("แบบบ้าน")]),t._v(" "),a("my-auto-complete",{attrs:{config:{getNullVal:!1},arrInputs:t.local.houseTemplate.inputs,placeholder:"ค้นหาแบบบ้าน",label:""},on:{select:t.houseSelectedHandle}})],1)]),t._v(" "),null!==t.local.houseTemplate.selected?a("div",{staticClass:"item-body"},[a("table",[t._m(0),t._v(" "),a("tbody",t._l(t.local.itemLists,function(e,i){return a("tr",{key:i},[a("td",[a("my-input",{attrs:{value:e.time,inputObj:{type:"text",name:"time_"+i,placeholder:"",validate:"required"},validator:t.$validator},on:{input:function(t){e.time=t}}})],1),t._v(" "),a("td",[a("my-input",{attrs:{value:e.name,inputObj:{type:"text",name:"name_"+i,placeholder:"",validate:"required"},validator:t.$validator},on:{input:function(t){e.name=t}}})],1),t._v(" "),a("td",[a("my-input",{attrs:{value:e.unit,inputObj:{type:"text",name:"unit_"+i,placeholder:"",validate:"required"},validator:t.$validator},on:{input:function(t){e.unit=t}}})],1),t._v(" "),a("td",[a("my-input",{attrs:{value:e.price,inputObj:{type:"text",name:"price_"+i,placeholder:"",validate:"required"},validator:t.$validator},on:{input:function(t){e.price=t}}})],1),t._v(" "),a("td",[a("my-input",{attrs:{value:e.note,inputObj:{type:"text",name:"note_"+i,placeholder:"",validate:""},validator:t.$validator},on:{input:function(t){e.note=t}}})],1),t._v(" "),a("td",[a("button",{staticClass:"button is-danger",on:{click:function(e){t.deleteTime(i)}}},[a("i",{staticClass:"fa fa-trash"})])])])}))])]):t._e(),t._v(" "),a("div",{staticClass:"item-footer container-block"},[a("div",{staticClass:"container-block block right"},[a("button",{staticClass:"button",on:{click:function(e){t.editRow("add")}}},[a("i",{staticClass:"fa fa-plus",attrs:{"aria-hidden":"true"}})])]),t._v(" "),a("div",{staticClass:"container-block block action"},[a("my-action",{attrs:{type:"update",obj:{title:"บันทึกข้อมูล",color:"is-info",isConfirm:!0}},on:{clickEvent:function(e){t.submitForm("update")}}})],1)])])])])])]],2)])],1)},staticRenderFns:[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",[a("th",{attrs:{width:"50"}},[t._v("งวด")]),t._v(" "),a("th",[t._v("รายการ")]),t._v(" "),a("th",{attrs:{width:"100"}},[t._v("หน่วย")]),t._v(" "),a("th",{attrs:{width:"150"}},[t._v("ราคา")]),t._v(" "),a("th",[t._v("หมายเหตุ")]),t._v(" "),a("th")])])}]};var h=a("VU/8")(m,v,!1,function(t){a("YWu2")},"data-v-7e803cfe",null);e.default=h.exports},YWu2:function(t,e){}});
//# sourceMappingURL=15.2f646e82fb63abe42982.js.map