webpackJsonp([1],{"B/YC":function(t,e){},"Xm+p":function(t,e){},aKlC:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("TfLM"),s=a("ujS/"),l=a("uvJ5"),r=a("Xxa5"),n=a.n(r),c=a("exGp"),o=a.n(c),d=a("NHnr"),u=a("STNA"),v=a("7x59"),h=a("Tdo9"),m=a("kVPM"),f=a("ikD4"),_=a("7Dwl"),p={props:{},components:{contractSerach:u.a,myAction:v.a,myInput:_.a,myAutoComplete:h.a},name:"OrderingExtra",data:function(){return{local:{contract:{inputs:[],selected:null},store:{inputs:[],selected:null},materialItems:[],materialSelected:[],note:""}}},created:function(){this.fetchData()},methods:{fetchData:function(){var t=this;return o()(n.a.mark(function e(){var a,i;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=[],e.next=3,f.a.getResource({resourceName:m.a.api.contract.dropdown,queryString:a});case 3:i=e.sent,t.local.contract.inputs=i.data;case 5:case"end":return e.stop()}},e,t)}))()},contractSelectedHandle:function(t){null!==t?(this.local.contract.selected=t.code,this.getStoreItems()):this.local.contract.selected=null},getStoreItems:function(){var t=this;return o()(n.a.mark(function e(){var a,i;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.BUILDPARAM({}),e.next=3,f.a.getResource({resourceName:m.a.api.store.dropdown,queryString:a});case 3:i=e.sent,t.local.store.inputs=i.data;case 5:case"end":return e.stop()}},e,t)}))()},storeSelectedHandle:function(t){this.local.materialSelected=[],null!==t?(this.local.store.selected=t.key,this.getMaterialItems()):this.local.store.selected=null},getMaterialItems:function(){var t=this;return o()(n.a.mark(function e(){var a,i;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.BUILDPARAM({contractId:t.local.contract.selected,store:t.local.store.selected}),e.next=3,f.a.getResource({resourceName:m.a.api.material.dropdown,queryString:a});case 3:i=e.sent,t.local.materialItems=i.data;case 5:case"end":return e.stop()}},e,t)}))()},editRow:function(t){"add"===t&&this.local.materialSelected.push({obj:null,amount:1})},deleteTime:function(t){this.local.materialSelected.splice(t,1)},submitForm:function(){var t=this;return o()(n.a.mark(function e(){var a,i,s,l;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.cleanData(),e.next=3,t.$validator.validateAll();case 3:if(e.sent){e.next=6;break}return e.abrupt("return");case 6:return a=""+m.a.api.ordering.extra,i={contract:t.local.contract.selected,materials:t.local.materialSelected,note:t.local.note},e.next=10,f.a.postResource({data:i,resourceName:a});case 10:if(200!==(s=e.sent).status){e.next=17;break}return l=s.data.orderingData,d.bus.$emit("setNotification",{type:"ordering",value:l}),t.NOTIFY("success"),t.GOTOPAGE("OrderingDetail","all"),e.abrupt("return");case 17:t.NOTIFY("error");case 18:case"end":return e.stop()}},e,t)}))()},cleanData:function(){this.local.materialSelected=this.local.materialSelected.filter(function(t){return null!=t.obj})}}},C={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"section-modal ordering-extra"},[a("h4",[t._v("สั่งซื้อพิเศษ")]),t._v(" "),a("div",{staticClass:"content"},[a("div",{staticClass:"field"},[a("contract-serach",{on:{select:t.contractSelectedHandle}})],1),t._v(" "),null!=this.local.contract.selected?a("div",{staticClass:"field"},[a("label",{staticClass:"label"},[t._v("ค้นหาประเภท")]),t._v(" "),a("div",{staticClass:"control"},[a("my-auto-complete",{attrs:{arrInputs:t.local.store.inputs,validator:t.$validator,placeholder:"ประเภทวัสดุ",label:""},on:{select:t.storeSelectedHandle}})],1)]):t._e(),t._v(" "),null!=this.local.contract.selected?a("div",{staticClass:"field"},[a("label",{staticClass:"label"},[t._v("ค้นหาวัสดุ")]),t._v(" "),a("div",{staticClass:"control"},[a("table",{staticClass:"table is-bordered rows-table"},[t._m(0),t._v(" "),a("tbody",t._l(t.local.materialSelected,function(e,i){return a("tr",{key:i},[a("td",[a("my-auto-complete",{attrs:{arrInputs:t.local.materialItems,validator:t.$validator,placeholder:"วัสดุ",label:""},on:{select:function(t){e.obj=t||null}}})],1),t._v(" "),a("td",[a("my-input",{attrs:{value:e.amount,inputObj:{type:"text",isBlur:!0,name:"amount",placeholder:"จำนวน",validate:"required"},validator:t.$validator},on:{input:function(t){e.amount=t}}})],1),t._v(" "),a("td",[a("button",{staticClass:"button is-danger",on:{click:function(e){t.deleteTime(i)}}},[a("i",{staticClass:"fa fa-trash"})])])])}))]),t._v(" "),a("div",{staticClass:"options"},[a("button",{staticClass:"button",on:{click:function(e){t.editRow("add")}}},[a("i",{staticClass:"fa fa-plus",attrs:{"aria-hidden":"true"}})])])])]):t._e(),t._v(" "),null!=this.local.contract.selected&&this.local.materialSelected.length?a("div",{staticClass:"field"},[a("label",{staticClass:"label"},[t._v("หมายเหตุ")]),t._v(" "),a("div",{staticClass:"control"},[a("my-input",{attrs:{value:t.local.note,inputObj:{type:"textarea",isBlur:!1,name:"note",placeholder:"หมายเหตุ",validate:"required"},validator:t.$validator},on:{input:function(e){t.local.note=e}}})],1)]):t._e()]),t._v(" "),null!=this.local.contract.selected?a("div",{staticClass:"footer"},[null!=this.local.contract.selected&&this.local.materialSelected.length?a("my-action",{attrs:{type:"update",obj:{title:"บันทึกข้อมูล"}},on:{clickEvent:function(e){t.submitForm()}}}):t._e()],1):t._e()])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",[this._v("ชื่อวัสดุ")]),this._v(" "),e("th",{attrs:{width:"80"}},[this._v("จำนวน")]),this._v(" "),e("th",{attrs:{width:"80"}})])])}]};var b=a("VU/8")(p,C,!1,function(t){a("B/YC")},"data-v-399a8d29",null).exports,g={props:{},components:{myAction:v.a,myInput:_.a,myAutoComplete:h.a},name:"OrderingExtra",data:function(){return{local:{store:{inputs:[],selected:null},materialSelected:[]}}},created:function(){this.fetchData()},methods:{fetchData:function(){var t=this;return o()(n.a.mark(function e(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.getStoreItems();case 1:case"end":return e.stop()}},e,t)}))()},getStoreItems:function(){var t=this;return o()(n.a.mark(function e(){var a,i;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.BUILDPARAM({type:"normal"}),e.next=3,f.a.getResource({resourceName:m.a.api.store.dropdown,queryString:a});case 3:i=e.sent,t.local.store.inputs=i.data;case 5:case"end":return e.stop()}},e,t)}))()},storeSelectedHandle:function(t){this.local.materialSelected=[],null!==t?(this.local.store.selected=t.key,this.getMaterialItems()):this.local.store.selected=null},getMaterialItems:function(){var t=this;return o()(n.a.mark(function e(){var a,i;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.BUILDPARAM({contractId:"null",store:t.local.store.selected}),e.next=3,f.a.getResource({resourceName:m.a.api.material.dropdown,queryString:a});case 3:i=e.sent,t.local.materialSelected=i.data.map(function(t){return{obj:{key:t.key,value:t.value},amount:1}});case 5:case"end":return e.stop()}},e,t)}))()},editRow:function(t){"add"===t&&this.local.materialSelected.push({obj:null,amount:1})},deleteTime:function(t){this.local.materialSelected.splice(t,1)},submitForm:function(){var t=this;return o()(n.a.mark(function e(){return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}},e,t)}))()},cleanData:function(){this.local.materialSelected=this.local.materialSelected.filter(function(t){return null!=t.obj})}}},S={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"section-modal ordering-extra"},[a("h4",[t._v("สั่งซื้อ (ปกติ)")]),t._v(" "),a("div",{staticClass:"content"},[a("div",{staticClass:"field"},[a("label",{staticClass:"label"},[t._v("ค้นหาประเภท")]),t._v(" "),a("div",{staticClass:"control"},[a("my-auto-complete",{attrs:{arrInputs:t.local.store.inputs,validator:t.$validator,placeholder:"ประเภทวัสดุ",label:""},on:{select:t.storeSelectedHandle}})],1)]),t._v(" "),a("div",{staticClass:"field"},[a("label",{staticClass:"label"},[t._v("ค้นหาวัสดุ")]),t._v(" "),a("div",{staticClass:"control"},[a("table",{staticClass:"table is-bordered rows-table"},[t._m(0),t._v(" "),a("tbody",t._l(t.local.materialSelected,function(e,i){return a("tr",{key:i},[a("td",[t._v("\n                "+t._s(e.obj.value)+"\n             ")]),t._v(" "),a("td",[t._v("\n               "+t._s(e.amount)+"\n                ")])])}))])])])]),t._v(" "),null!=this.local.store.selected&&this.local.materialSelected.length?a("div",{staticClass:"footer"},[a("my-action",{attrs:{type:"update",obj:{title:"ออกใบสั่งซื้อ"}},on:{clickEvent:function(e){t.submitForm()}}})],1):t._e()])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",[this._v("ชื่อวัสดุ")]),this._v(" "),e("th",{attrs:{width:"80"}},[this._v("จำนวน")])])])}]};var k=a("VU/8")(g,S,!1,function(t){a("Xm+p")},"data-v-6f69de21",null).exports,y={props:{},components:{barChart:i.a,breadcrumbBar:s.a,ModelPanel:l.a,extraComp:b,normalComp:k},name:"OrderingPage",data:function(){return{local:{pageObj:{items:[{name:"การสั่งซื้อ",route:"Ordering",key:"",active:!0,icon:"fa fa-object-group"}]},ordering:null,chart:null,orderingComponent:b}}},computed:{},created:function(){this.fetchData()},methods:{fetchData:function(){var t=this,e=""+m.a.api.ordering.home;f.a.getResource({resourceName:e,queryString:[]}).then(function(e){200===e.status&&(t.local.ordering=e.data.ordering,t.local.chart=e.data.chart)}).catch(function(){})},showOrderingForm:function(t){this.$refs.modelPanel.isActive=!0,this.local.orderingComponent="normal"===t?k:b}}},w={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return null!=t.local.ordering?a("section",{staticClass:"section ordering-page"},[a("breadcrumb-bar",{attrs:{dataObj:t.local.pageObj}}),t._v(" "),a("div",{staticClass:"container-block"},[a("div",{staticClass:"tile is-ancestor"},[a("div",{staticClass:"tile is-vertical is-12"},[a("div",{staticClass:"tile"},[a("div",{staticClass:"tile is-parent is-vertical is-6"},[a("article",{staticClass:"tile is-child notification"},[a("div",{staticClass:"title"},[t._v("จำนวนการซื้อ")]),t._v(" "),a("bar-chart",{attrs:{data:t.local.chart.normal,height:150}})],1)]),t._v(" "),a("div",{staticClass:"tile is-parent"},[a("article",{staticClass:"tile is-child notification"},[a("div",{staticClass:"title"},[t._v("จำนวนการซื้อ (พิเศษ)")]),t._v(" "),a("bar-chart",{attrs:{data:t.local.chart.extra,height:150}})],1)])]),t._v(" "),a("div",{staticClass:"tile"},[a("div",{staticClass:"tile is-parent is-vertical is-6"},[a("article",{staticClass:"tile is-child notification"},[a("div",{staticClass:"header-title container-block"},[a("div",{staticClass:"title-left"},[a("div",{staticClass:"title"},[t._v("คำขอสั่งซื้อใหม่ "+t._s(t.local.ordering.normal.length)+" รายการ")])]),t._v(" "),a("div",{staticClass:"title-right"},[a("span",{staticClass:"tag is-light",on:{click:function(e){t.GOTOPAGE("OrderingDetail","all")}}},[t._v("ดูข้อมูล")])])]),t._v(" "),a("table",{staticClass:"table is-narrow rows-table"},[t._m(0),t._v(" "),a("tbody",t._l(t.local.ordering.normal,function(e,i){return a("tr",{key:i,on:{dblclick:function(a){t.GOTOPAGE("OrderingDetail",e.contract_code)}}},[a("td",[t._v(t._s(e.contract_code))]),t._v(" "),a("td",[t._v(t._s(e.amount))]),t._v(" "),a("td",[t._v(t._s(t.NUMBERWITHCOMMAS(e.total_price)))]),t._v(" "),a("td",[t._v(t._s(t.SET_DATEFORMAT(e.created_at)))])])}))])])]),t._v(" "),a("div",{staticClass:"tile is-parent is-vertical is-6"},[a("article",{staticClass:"tile is-child notification"},[a("div",{staticClass:"header-title container-block"},[a("div",{staticClass:"title-left"},[a("div",{staticClass:"title extar"},[t._v("คำขอสั่งซื้อใหม่ (พิเศษ) "+t._s(t.local.ordering.extra.length)+" รายการ")])]),t._v(" "),a("div",{staticClass:"title-right"},[a("span",{staticClass:"tag is-light",on:{click:function(e){t.GOTOPAGE("OrderingDetail","all")}}},[t._v("ดูข้อมูล")])])]),t._v(" "),a("table",{staticClass:"table is-narrow rows-table"},[t._m(1),t._v(" "),a("tbody",t._l(t.local.ordering.extra,function(e,i){return a("tr",{key:i,on:{dblclick:function(a){t.GOTOPAGE("OrderingDetail",e.contract_code)}}},[a("td",[t._v(t._s(e.contract_code))]),t._v(" "),a("td",[t._v(t._s(e.amount))]),t._v(" "),a("td",[t._v(t._s(t.NUMBERWITHCOMMAS(e.total_price)))]),t._v(" "),a("td",[t._v(t._s(t.SET_DATEFORMAT(e.created_at)))])])}))])])])]),t._v(" "),a("div",{staticClass:"tile function"},[a("div",{staticClass:"tile is-parent is-vertical is-6"},[a("article",{staticClass:"tile is-child notification container-block",on:{click:function(e){t.showOrderingForm("normal")}}},[t._m(2)])]),t._v(" "),a("div",{staticClass:"tile is-parent is-vertical is-6"},[a("article",{staticClass:"tile is-child notification container-block",on:{click:function(e){t.showOrderingForm("extra")}}},[t._m(3)])])])])])]),t._v(" "),a("model-panel",{ref:"modelPanel"},[a(t.local.orderingComponent,{ref:"ordering",tag:"component"})],1)],1):t._e()},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",[this._v("เลขที่สัญญา")]),this._v(" "),e("th",[this._v("จำนวนรายการ")]),this._v(" "),e("th",[this._v("ราคารวม")]),this._v(" "),e("th",[this._v("วันที่")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",[this._v("เลขที่สัญญา")]),this._v(" "),e("th",[this._v("จำนวนรายการ")]),this._v(" "),e("th",[this._v("ราคารวม")]),this._v(" "),e("th",[this._v("วันที่")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"block title"},[e("i",{staticClass:"fa fa-plus-circle",attrs:{"aria-hidden":"true"}}),this._v(" สั่งซื้อปกติ")])},function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"block title"},[e("i",{staticClass:"fa fa-plus-circle",attrs:{"aria-hidden":"true"}}),this._v(" สั่งซื้อพิเศษ")])}]};var x=a("VU/8")(y,w,!1,function(t){a("vtU8")},null,null);e.default=x.exports},mZsO:function(t,e){},uvJ5:function(t,e,a){"use strict";var i={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:["modal",{"is-active":t.isActive}]},[a("div",{staticClass:"modal-background",on:{click:function(e){t.closeModel()}}}),t._v(" "),a("div",{staticClass:"modal-content"},[t._t("default")],2)])},staticRenderFns:[]};var s=a("VU/8")({props:{},components:{},name:"Model",data:function(){return{isActive:!1}},computed:{},created:function(){},methods:{closeModel:function(){this.isActive=!1}}},i,!1,function(t){a("mZsO")},null,null);e.a=s.exports},vtU8:function(t,e){}});
//# sourceMappingURL=1.32bca0f4cd3164cf670f.js.map